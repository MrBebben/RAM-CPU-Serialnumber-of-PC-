// Author: Bebben
// Description: Checks if Nitrewave is alting guys!

using System;
using System.Diagnostics;
using System.IO;

class Program
{
    static void Main(string[] args)
    {
        // Define the PowerShell commands to be executed
        string[] commands = {
            "Get-WmiObject win32_processor | Select-Object ProcessorId",
            "Get-WmiObject Win32_PhysicalMemory | Select-Object SerialNumber",
            "Get-WmiObject Win32_DiskDrive | Select-Object SerialNumber"
        };

        // Get the current directory and set the output file path
        string outputPath = Path.Combine(Directory.GetCurrentDirectory(), "hardware_info.txt");

        // Create or overwrite the text file
        using (StreamWriter writer = new StreamWriter(outputPath))
        {
            foreach (var command in commands)
            {
                writer.WriteLine($"Running command: {command}");
                
                // Run the PowerShell command and capture the output
                string result = RunPowerShellCommand(command);
                
                // Write the output to the file
                writer.WriteLine(result);
                writer.WriteLine(new string('=', 50));  // Separate the results for readability
            }
        }

        Console.WriteLine($"Output written to {outputPath}");
    }

    // Method to run PowerShell commands and return the output
    static string RunPowerShellCommand(string command)
    {
        ProcessStartInfo psi = new ProcessStartInfo
        {
            FileName = "powershell.exe",
            Arguments = $"-Command \"{command}\"",
            RedirectStandardOutput = true,
            UseShellExecute = false,
            CreateNoWindow = true
        };

        using (Process process = Process.Start(psi))
        {
            using (StreamReader reader = process.StandardOutput)
            {
                return reader.ReadToEnd();
            }
        }
    }
}
